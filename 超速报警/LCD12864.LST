C51 COMPILER V9.00   LCD12864                                                              05/22/2016 00:43:49 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LCD12864
OBJECT MODULE PLACED IN LCD12864.OBJ
COMPILER INVOKED BY: E:\software\DevelopmentSoftware\InstallSrc\KeilC51\C51\BIN\C51.EXE LCD12864.c COMPACT BROWSE DEBUG 
                    -OBJECTEXTEND

line level    source

   1          #include "stc15.h"
   2          #include "intrins.h"
   3          #include "Delay.h"
   4          
   5          #define uchar unsigned char 
   6          #define LCMdata P0 
   7          #define Busy 0x80  
   8          
   9          sbit RS=P2^7;  //P1.3
  10          sbit RW=P2^6;  //P1.2
  11          sbit E=P2^5;   //P1.1  
  12          sbit REST=P2^4;  //P2.0
  13          
  14          void Display_String(uchar line,uchar *string); 
  15          void Wr_Data(uchar wrdata); //写数据   
  16          void Wr_Command(uchar wrcommand,busyc); //写指令 
  17          void RDbf(void);//读忙状态 
  18          void Lcm_Init(void);//液晶初始化                  
  19          
  20          void Display_String(uchar line,uchar *string)//显示字符串 
  21          {   
  22   1      uchar addr;  
  23   1      if(line==1)   addr=0x80;  
  24   1      else if(line==2)   addr=0x90;  
  25   1      else if(line==3)   addr=0x88;   
  26   1      else if(line==4)   addr=0x98;      
  27   1      Wr_Command(addr,1);  
  28   1      while(*string)
  29   1      {
  30   2              Wr_Data(*string++); 
  31   2      }
  32   1          
  33   1      }
  34          
  35          void Wr_Data(uchar wrdata) //写数据 
  36          {  
  37   1      RDbf();  
  38   1      RS=1;  
  39   1      RW=0;
  40   1      Delay5us();  
  41   1      E=1;  
  42   1      LCMdata=wrdata;
  43   1      Delay5us();  
  44   1      E=0;  
  45   1      }  
  46          
  47          void Wr_Command(uchar wrcommand,busyc) //写指令 
  48          {  
  49   1      if(busyc)   RDbf();  
  50   1      RS=0;  
  51   1      RW=0;
  52   1      Delay5us();  
  53   1      E=1;  
  54   1      LCMdata=wrcommand;
C51 COMPILER V9.00   LCD12864                                                              05/22/2016 00:43:49 PAGE 2   

  55   1      Delay5us();  
  56   1      E=0; 
  57   1      }  
  58          
  59          void RDbf(void) //读忙状态 
  60          { 
  61   1      while(1)  
  62   1      {   
  63   2      RS=0;    
  64   2      RW=1; 
  65   2      E=0;   
  66   2      LCMdata=0xFF;     
  67   2      E=1;   
  68   2      if((LCMdata&Busy)==0)   break;  
  69   2      } 
  70   1      }
  71          
  72          void Lcm_Init(void) 
  73          {  
  74   1      Delay5Ms();     
  75   1      REST=1;     
  76   1      REST=0;     
  77   1      REST=1;   
  78   1      Wr_Command(0x30,0);  
  79   1      Delay5Ms();  
  80   1      Wr_Command(0x30,0); //2 次显示模式设置，不用判忙  
  81   1      Delay5Ms();  
  82   1      Wr_Command(0x0C,1); //开显示及光标设置  
  83   1      Delay5Ms(); 
  84   1      Wr_Command(0x01,1); //显示清屏  
  85   1      Delay5Ms();  
  86   1      Delay5Ms();  
  87   1      Wr_Command(0x06,1); //显示光标移动设置  
  88   1      Delay5Ms(); 
  89   1      }
  90          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    241    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----       6
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
